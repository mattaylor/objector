const O=Object,C="constructor",K=O.keys,A=O.assign,I=Symbol.iterator,M={every(t){for(let e in this)if(!t(this[e],e))return!1;return!0},some(t){for(let e in this)if(t(this[e],e))return!0;return!1},map(t,e={}){for(let i in this)e[i]=t(this[i],i);return e},has(t){return this.some(e=>t==e)},pick(t,e={}){for(let i in this)(t.call?t(this[i],i):t.has(i))&&(e[i]=this[i]);return e},flatMap(t,e={}){for(let i of K(this))for(let[r,s]of t(i,this[i]))e[r]=s;return e},clean(){return this.pick(t=>t)},is(t,e){return e||t!=O?this[C]==t||!e&&this instanceof t:![Number,String,Boolean,Function,Symbol].has(this[C])},find(t){for(let e in this)if(t.call?t(this[e],e):this[e].eq(t))return e},extend(...t){return A({},...t).map((t,e)=>this[e]??t,this)},delete(...t){for(let e of t)delete this[e];return this},clone(t){return this.is(O)?[O,Array].has(this[C])?this.map(e=>t&&e?e.clone(t-1):e):new this[C](this):this.valueOf()},join(...t){let e=A({},this);for(let i of t)K(i).map(t=>e[t]&&=[].concat(e[t],i[t]));return e},split(t=[]){for(let e in this)this[e].map((i,r)=>t[r]?t[r][e]=i:t[r]={[e]:i});return t},same(t){return this.pick((e,i)=>e.eq(t[i]))},diff(t){return this.pick((e,i)=>!e.eq(t[i]))},contains(t,e){return t.every((t,e)=>this[e]?.eq(t))||e&&this.some(i=>i.contains(t,e-1))},eq(t,e){return this==t||t&&this.is(t[C])&&this.size()==t.size()&&!(this-t)&&this.every((i,r)=>i==t[r]||e&&i?.eq(t[r],e-1))},size(){return K(this).length},keyBy(t,e,i={}){return this.map(r=>i[e=r.at(t)]=i[e]?[r].concat(i[e]):r),i},at(t){return this[t]||t.split(".").reduce((t,e)=>t[e],this)},$(t){return t?t.is(String)?t.replace(/\${?([\w\.]+)}?/g,(t,e)=>this.at(e).$()):(t.stringify||t)(this):this.$(JSON).replace(/"(\w+)":/g,"$1:")},memo(t){return t?(...e)=>this[e.$()]??=(this.wait(t).then(t=>delete t[e.$()]),this(...e)):this},bind(t,e,i){return def(this,t,(function(...t){return e(...t,this)}).memo(i)),this},log(t="",e,i="log"){return(!e||e(this))&&console[i](Date().slice(4,24),"-",t,this.$()),this},try(t,e,i,r){try{r=t(this)}catch(s){r=e&&e(s,this)}return i?this:r},new(t){return this._t?new Proxy(this._t.new(t),this._h):A(this.create(),t)},wait(t){return new Promise((e,i)=>t.is(Number)?setTimeout(()=>e(this),1e3*t):(t=t(this,e,i))&&e(t))},trap(t,e,...i){return new Proxy(this,{set(r,s,h){if((!i[0]||i._find(s))&&!t(h,s,r)&&e)throw e+" "+[s,h].$();return r[s]=h},get(t,e){return({_t:t,_h:this})[e]||t[e]}})}};for(let m of["keys","values","entries","create","assign"])M[m]=function(...t){return O[m](this,...t)};let def=(t,e,i)=>(O.defineProperty(t,e,{writable:!0,value:i}),i);for(let m in O.prototype[I]=function(){return this.values()[I]()},M){[m,"_"+m].map(t=>def(O.prototype,t,M[m]));try{module.exports[m]=(t,...e)=>t["_"+m](...e)}catch{}}